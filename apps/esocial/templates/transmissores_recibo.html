{% load esocial_custom_tags %}
{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Recibo do Lote de Eventos</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="{% static 'dist/css/AdminLTE.min.css' %}">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        table.bordasimples {
            border-collapse: collapse;
        }
        table.bordasimples tr td {
            border: 1px solid #333333;
        }
        * {
            color: #000;
            font-size: 12px;
            font-family: Arial, Tahoma, Verdana;
        }
        h1 {
            font-weight: bold;
            color: #000;
            font-size: 32px;
            font-family: Arial, Tahoma, Verdana;
        }
        h2 {
            font-weight: bold;
            color: #000;
            font-size: 24px;
            font-family: Arial, Tahoma, Verdana;
        }
        h3 {
            font-weight: bold;
            color: #000;
            font-size: 20px;
            font-family: Arial, Tahoma, Verdana;
        }
        h4 {
            font-weight: bold;
            color: #000;
            font-size: 16px;
            font-family: Arial, Tahoma, Verdana;
        }
    </style>
</head>
<div class="wrapper">
    <section class="invoice">
        <div class="row">
            <div class="col-xs-12">
                <h2 class="page-header">Recibo do Lote de Eventos
                    <small class="pull-right">Data: {{ data|date:"SHORT_DATE_FORMAT" }}</small>
                </h2>
            </div>
        </div>
        <div class="row invoice-info">
            <div class="col-sm-4 invoice-col">TRANSMISSOR<br>
                <strong>
                    Tipo de
                    Inscrição:
                </strong>&nbsp;{{ transmissor_lote_esocial.transmissor.get_transmissor_tpinsc_display }}<br><strong>Número
                    de Inscrição:</strong>&nbsp;
                    {{ transmissor_lote_esocial.transmissor.transmissor_nrinsc }}
                
            </div>
            <div class="col-sm-4 invoice-col">EMPREGADOR<br>
                <strong>Tipo de
                    Inscrição:</strong>&nbsp;{{ transmissor_lote_esocial.get_empregador_tpinsc_display }}<br><strong>Número
                    de Inscrição:</strong>&nbsp;{{ transmissor_lote_esocial.empregador_nrinsc }}
            </div>
            <div class="col-sm-4 invoice-col">GRUPO
                <strong>{{ transmissor_lote_esocial.get_grupo_display }}</strong>
            </div>
        </div>
        <div class="row invoice-info">
            <div class="col-sm-4 invoice-col">RESPOSTA<br>
                
                    <strong>Código:</strong>&nbsp;{{ transmissor_lote_esocial.get_resposta_codigo_display }}<br><strong>Descrição:</strong>&nbsp;
                    {% if transmissor_lote_esocial.resposta_descricao %}
                        {{ transmissor_lote_esocial.resposta_descricao }}{% else %}-{% endif %}
            </div>
            <div class="col-sm-4 invoice-col">RECEPÇÃO<br>
                <strong>Data/Hora:</strong>&nbsp;{% if transmissor_lote_esocial.recepcao_data_hora %}
                    {{ transmissor_lote_esocial.recepcao_data_hora }}{% else %}-{% endif %}<br><strong>Versão do
                    Aplicativo:</strong>&nbsp;{% if transmissor_lote_esocial.recepcao_versao_aplicativo %}
                    {{ transmissor_lote_esocial.recepcao_versao_aplicativo }}{% else %}-{% endif %}<br><strong>Protocolo:</strong>&nbsp;
                    {% if transmissor_lote_esocial.protocolo %} {{ transmissor_lote_esocial.protocolo }}{% else %}
                        -{% endif %}
            </div>
            <div class="col-sm-4 invoice-col">PROCESSAMENTO
                <strong>Versão do Aplicativo:</strong>&nbsp;
                    {% if transmissor_lote_esocial.processamento_versao_aplicativo %}
                        {{ transmissor_lote_esocial.processamento_versao_aplicativo }}{% else %}-{% endif %}<br><strong>Tempo
                        Estimado de Conclusão (segundos):</strong>&nbsp;
                    {% if transmissor_lote_esocial.tempo_estimado_conclusao %}
                        {{ transmissor_lote_esocial.tempo_estimado_conclusao }}{% else %}-{% endif %}
            </div>
        </div>

        {##}
        {#    {{ retorno_consulta_json }}#}


        {#    {% for a,b in retorno_consulta_json.retornoProcessamentoLoteEventos.retornoEventos.evento.retornoEvento.eSocial.retornoEvento.items %}<br>#}
        {#{{ a }} - {{ b }}#}
        {#        {% if a == '@Id' %}IDENTIDADE: {{ b }}{% endif %}#}
        {#        {% if a == '@Id' %}IDENTIDADE: {{ b }}{% endif %}#}
        {#    {% endfor %}#}


        {#    {{ retorno_consulta_json|finditem:'@Id' }}#}
        {#    {% for a in retorno_consulta_json.retornoProcessamentoLoteEventos.retornoEventos.evento.retornoEvento.eSocial.retornoEvento %}#}
        {#        <br>#}
        {#        <br>#}
        {#        <br>#}
        {#{{ a }} - {{ a.values.0 }}#}
        {#    {% endfor %}#}


        <div class="row invoice-info">
            <div class="col-xs-12 table-responsive"><h4>Eventos</h4></div>
        </div>
        <div class="row invoice-info">
            <div class="col-xs-12 table-responsive">
                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th>Identidade</th>
                        <th>Código da<br>Resposta</th>
                        <th>Descrição da<br>Resposta</th>
                        <th>Número do Recibo</th>
                        <th>Hash</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for a, b in retorno_consulta_json.retornoProcessamentoLoteEventos.retornoEventos.evento.retornoEvento.items %}
                        <tr>
                            <td>{% if b|finditem:'@Id' %}{{ b|finditem:'@Id' }}{% endif %}</td>
                            <td>{% if b|finditem:'cdResposta' %}{{ b|finditem:'cdResposta' }}{% endif %}</td>
                            <td>{% if b|finditem:'descResposta' %}{{ b|finditem:'descResposta' }}{% endif %}</td>
                            <td>{% if b|finditem:'nrRecibo' %}{{ b|finditem:'nrRecibo' }}{% endif %}</td>
                            <td>{% if b|finditem:'hash' %}{{ b|finditem:'hash' }}{% endif %}</td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="4">Os eventos enviados por este lote apresentaram erros ou Este lote não
                                possuia eventos vinculados!
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <div class="row invoice-info">
            <div class="col-xs-12 table-responsive"><h4>Ocorrências do Lote</h4></div>
        </div>
        <div class="row invoice-info">
            <div class="col-xs-12 table-responsive">
                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th>Código</th>
                        <th>Descrição</th>
                        <th>Tipo</th>
                        <th>Localização</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for a, b in ocorrencias_json.items %}
                        <tr>
                            {% for c,d in b.items %}{% if c == 'codigo' %}
                                <td>{{ d }}</td>{% endif %}{% endfor %}
                            {% for c,d in b.items %}{% if c == 'descricao' %}
                                <td>{{ d }}</td>{% endif %}{% endfor %}
                            {% for c,d in b.items %}{% if c == 'tipo' %}
                                <td>{{ d }}</td>{% endif %}{% endfor %}
                            {% for c,d in b.items %}{% if c == 'localizacao' %}
                                <td>{{ d }}</td>{% endif %}{% endfor %}
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="4">Este lote não possui ocorrências registradas!</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </section>
</div>
</body>
</html>